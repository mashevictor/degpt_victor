(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0a4828"],{"076a":function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t._self._c;return s("div",{staticClass:"wbs-content-inner"},[s("div",{staticClass:"wbs-main"},[t.isLoaded?s("div",{staticClass:"opt-group"},[s("div",{staticClass:"opt-group-hd"},[t._m(0),s("div",{staticClass:"group-description"},[s("p",[t._v(" 启用数据库优化模块，对数据库进行适当的清理、优化有利于提升数据库性能。 ")]),s("el-alert",{staticClass:"mt",attrs:{title:"在操作数据库优化前，务必做好数据库备份，以下操作不可逆。",type:"warning","show-icon":"",center:"",closable:!1}})],1),t.$cnf.is_pro?t._e():s("div",{staticClass:"mt"},[s("el-button",{attrs:{type:"primary"},on:{click:function(s){return t.getPro()}}},[t._v("升级至PRO")])],1),s("div",{directives:[{name:"esle",rawName:"v-esle"}],staticClass:"mt"},[s("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.optimizeNow}},[t._v("立即优化数据库")])],1)]),s("wbs-opt-box",{attrs:{name:"修订版本",desc:"每当您保存草稿或更新已发布的WordPress页面或文章时，内容管理系统 (CMS) 都会自动创建修订。 您运行站点的时间越长，您可能在数据库中存储的修订就越多。","doc-link":"https://www.wbolt.com/wordpress-revisions.html"},scopedSlots:t._u([{key:"ctrlItems",fn:function(){return[s("div",{staticClass:"align-center"},[s("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:t.opt.post_revisions,callback:function(s){t.$set(t.opt,"post_revisions",s)},expression:"opt.post_revisions"}}),s("p",{staticClass:"mt"},[t._v("找到"+t._s(t.state.post_revisions)+"修订版本")])],1)]},proxy:!0}],null,!1,2516443074)}),s("wbs-opt-box",{attrs:{name:"自动草稿",desc:"在您编辑文章时，WordPress会自动保存您的文章内容。这称为自动草稿。就像修订一样，这些会随着时间的推移在您的数据库中造成积累，导致资源浪费。","doc-link":"https://www.wbolt.com/wordpress-auto-drafts.html"},scopedSlots:t._u([{key:"ctrlItems",fn:function(){return[s("div",{staticClass:"align-center"},[s("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:t.opt.post_auto_drafts,callback:function(s){t.$set(t.opt,"post_auto_drafts",s)},expression:"opt.post_auto_drafts"}}),s("p",{staticClass:"mt"},[t._v("找到"+t._s(t.state.post_auto_drafts)+"自动草稿")])],1)]},proxy:!0}],null,!1,612570878)}),s("wbs-opt-box",{attrs:{name:"回收站文章",desc:"回收站文章，如果没有及时清理，会随着网站的发展积累越来越多。在一定程度上会影响性能。建议及时清理不必要的回收站文章。","doc-link":"https://www.wbolt.com/wordpress-auto-drafts.html"},scopedSlots:t._u([{key:"ctrlItems",fn:function(){return[s("div",{staticClass:"align-center"},[s("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:t.opt.trashed_posts,callback:function(s){t.$set(t.opt,"trashed_posts",s)},expression:"opt.trashed_posts"}}),s("p",{staticClass:"mt"},[t._v("找到"+t._s(t.state.trashed_posts)+"回收站文章")])],1)]},proxy:!0}],null,!1,2536780284)}),s("wbs-opt-box",{attrs:{name:"垃圾评论",desc:"对WordPress熟悉的朋友，相信都清楚垃圾评论的恐怖之处，只要你开启评论功能，它们总是无孔不入的。建议安装Akismet反垃圾平台插件，并及时清理垃圾评论。","doc-link":""},scopedSlots:t._u([{key:"ctrlItems",fn:function(){return[s("div",{staticClass:"align-center"},[s("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:t.opt.spam_comments,callback:function(s){t.$set(t.opt,"spam_comments",s)},expression:"opt.spam_comments"}}),s("p",{staticClass:"mt"},[t._v("找到"+t._s(t.state.spam_comments)+"垃圾评论")])],1)]},proxy:!0}],null,!1,4133203337)}),s("wbs-opt-box",{attrs:{name:"回收站评论",desc:"回收站评论，与回收站文章类似，用于暂时存放丢弃的评论留言。如未能及时清理，会随着时间迁移积累大量数据。","doc-link":""},scopedSlots:t._u([{key:"ctrlItems",fn:function(){return[s("div",{staticClass:"align-center"},[s("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:t.opt.trashed_comments,callback:function(s){t.$set(t.opt,"trashed_comments",s)},expression:"opt.trashed_comments"}}),s("p",{staticClass:"mt"},[t._v("找到"+t._s(t.state.trashed_comments)+"回收站评论")])],1)]},proxy:!0}],null,!1,2167620261)}),s("wbs-opt-box",{attrs:{name:"过期瞬态",desc:"除非您使用对象缓存，否则WordPress会在wp_options表中存储临时记录。通常这些都有一个过期时间，应该会随着时间的推移而消失。然而，情况并非总是如此。我们已经看到一些数据库中有数千条旧的临时记录。","doc-link":"https://www.wbolt.com/wp-options-autoloaded-data.html#clean-up-transients"},scopedSlots:t._u([{key:"ctrlItems",fn:function(){return[s("div",{staticClass:"align-center"},[s("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:t.opt.expired_transients,callback:function(s){t.$set(t.opt,"expired_transients",s)},expression:"opt.expired_transients"}}),s("p",{staticClass:"mt"},[t._v("找到"+t._s(t.state.expired_transients)+"过期瞬态")])],1)]},proxy:!0}],null,!1,1786661055)}),s("wbs-opt-box",{attrs:{name:"所有瞬态",desc:"开启此项会连同最新的临时记录一起清除。一般不建议开启此项，以免误杀一些当前需要的临时记录。","doc-link":"https://www.wbolt.com/wp-options-autoloaded-data.html#clean-up-transients"},scopedSlots:t._u([{key:"ctrlItems",fn:function(){return[s("div",{staticClass:"align-center"},[s("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:t.opt.all_transients,callback:function(s){t.$set(t.opt,"all_transients",s)},expression:"opt.all_transients"}}),s("p",{staticClass:"mt"},[t._v("找到"+t._s(t.state.all_transients)+"瞬态")])],1)]},proxy:!0}],null,!1,166937927)}),s("wbs-opt-box",{attrs:{name:"数据库表",desc:"MySQL有一个OPTIMIZE TABLE命令，可用于回收MySQL安装中未使用的空间。这类似于硬盘碎片整理。注：该选项仅适用于MyISAM表，不适用于InnoDB表。","doc-link":"https://www.wbolt.com/wp-options-autoloaded-data.html#clean-up-transients"},scopedSlots:t._u([{key:"ctrlItems",fn:function(){return[s("div",{staticClass:"align-center"},[s("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:t.opt.optimize,callback:function(s){t.$set(t.opt,"optimize",s)},expression:"opt.optimize"}}),s("p",{staticClass:"mt"},[t._v("找到"+t._s(t.state.optimize)+"未优化表")])],1)]},proxy:!0}],null,!1,1650238822)}),s("wbs-opt-box",{attrs:{name:"定期优化",desc:"如果您是一位懒人站长，可以根据网站的实际情况，设置定期优化数据库。插件将会根据上面的设置项，定期执行任务。注：默认为当前时区的凌晨3点钟执行。","doc-link":""},scopedSlots:t._u([{key:"ctrlItems",fn:function(){return[s("el-select",{attrs:{size:"mini",placeholder:"请选择"},model:{value:t.opt.schedule,callback:function(s){t.$set(t.opt,"schedule",s)},expression:"opt.schedule"}},[s("el-option",{attrs:{value:"off",label:"停用（默认）"}}),s("el-option",{attrs:{value:"daily",label:"每天"}}),s("el-option",{attrs:{value:"weekly",label:"每周"}}),s("el-option",{attrs:{value:"month",label:"每月"}})],1)]},proxy:!0}],null,!1,215583200)})],1):t._e(),s("wb-prompt",{directives:[{name:"show",rawName:"v-show",value:t.isLoaded,expression:"isLoaded"}],staticClass:"mt"})],1),s("wbs-ctrl-bar",{directives:[{name:"show",rawName:"v-show",value:t.isLoaded,expression:"isLoaded"}],on:{submit:t.updateData}})],1)},o=[function(){var t=this,s=t._self._c;return s("h3",{staticClass:"group-name"},[s("strong",[t._v("数据库优化")])])}],n={name:"WPTurboDatabases",components:{},provide(){return{needPro:!0}},inject:["getPro"],data(){const t=this;return{wb_cnf:t.$cnf,form_changed:0,isLoaded:0,loading:0,is_pro:t.$cnf.is_pro,opt:{},value:"",radio:"1",input:"",state:{}}},created(){const t=this;t.loadData(),t.$verify((s,e)=>{t.$cnf.is_pro=s})},methods:{optimizeNow(){const t=this;t.$wbui.confirm("基于设置选项立即优化数据库？优化前请确保已备份数据库。",(function(){t.loading=t.$wbui.loading(),t.$api.getData({_ajax_nonce:_wb_wpturbo_ajax_nonce,action:t.$cnf.action.act,op:"database_optimize",opt:t.opt}).then(s=>{t.$wbui.close(t.loading),t.state=s["data"]})}))},loadData(){const t=this;t.loading=t.$wbui.loading(),t.$api.getData({_ajax_nonce:_wb_wpturbo_ajax_nonce,action:t.$cnf.action.act,op:"database_setting"}).then(s=>{t.$wbui.close(t.loading),t.opt=s["opt"],t.state=s["data"],t.isLoaded=1})},updateData(t){const s=this;if(!s.$cnf.is_pro)return;const e={_ajax_nonce:_wb_wpturbo_ajax_nonce,action:s.$cnf.action.act,op:"database_update",opt:s.opt};s.$api.saveData(e).then(e=>{s.$wbui.toast("设置保存成功"),s.form_changed=1,t&&t()})}},watch:{opt:{handler(){this.form_changed++},deep:!0}},beforeRouteLeave(t,s,e){const a=this;a.form_changed>1?a.$wbui.open({content:"您修改的设置尚未保存，确定离开此页面吗？",btn:["保存并离开","放弃修改"],yes(){return e(!1),a.updateData((function(){e()})),!1},no(){return e(),!1}}):e()}},i=n,l=e("2877"),c=Object(l["a"])(i,a,o,!1,null,null,null);s["default"]=c.exports}}]);